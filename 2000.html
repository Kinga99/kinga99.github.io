<!doctype html>
<html lang=en>
<head>
<title>Data Visualization Final Project</title>
<meta charset=utf-8>
<link rel="stylesheet" type="text/css" href="FinalProject.css">
<script src="//d3js.org/d3.v3.min.js" charset="utf-8"></script>
</head>

<body id="content">
<div id="wrapper">

<header>
    <h1>Number of Deaths by Risk Factor </h1>
    <h2>United States </h2>
<img src="Cigarettes.PNG" >
<img src="Image1.PNG" >
<img src="Image2.PNG">
<img src="Image3.PNG" >
<img src="Image5.PNG">
</header>

<div id="menu">
  <ul>
    <li><a href="index.html" title="1990" >&#9664 1990</a></li>
    <li><a href="2000.html" title="2000" class="current">2000</a></li>
<li><a href="2017.html" title="2017" >2017 &#9658</a></li>    
  </ul>
</div>
<!--[if lte IE 7]>
<br>
<![endif]-->


 <div id="left"><h3>In 2000...</h3>
  <p id="comment">
Finally, the numbers of smokers started decreesing. Also, less people struggled
with high cholesterol. But as drinking sodas gained in popularity, and the digital world exploded more 
americans faced the issue of <mark>obesity</mark>. Diabeties caused by <mark>high blood sugar</mark>
killed about 15% more people than in the previous decade. Another
astounding statistic is the number of deaths caused by <mark>unsafe sex</mark>, it nearly doubled 
from the previous decade! Digital revolution and social media influenced
our mood and feeling of loneliness, <mark>alcohol use </mark>and <mark>drug use</mark>
are now killing more people than in the last 10 years. 

</p></div>
<div id="right">
<svg id="graph" ></svg>
<p id="legend"><mark id="orange">&#9632</mark>Increesed since 1990 &nbsp;&nbsp;&nbsp;&nbsp;   <mark id="green">&#9632</mark>Decreesed since 1990  </p>

</div>
    <script>
      var margins = {
        top: 20,
        left: 150,
        right: 150,
        bottom: 10
      };
      var legendPanel = {
        width: 100
      };

      var dataset = [{
        data: [{
        yValue: 'Smoking',
        xValue: 482722
      }, {
        yValue: 'High blood presure',
        xValue: 493669
      }, {
        yValue: 'High cholesterol',
        xValue: 276041
      }, {
        yValue: 'Obesity',
        xValue: 255035
      }, {
        yValue: 'High blood sugar',
        xValue: 236444
      }, {
         yValue: 'Diet low in whole grains',
        xValue: 137927
      }, {
        yValue: 'Diet low in nuts and seeds',
        xValue: 114308
      }, {
        yValue: 'Outdoor air pollution',
        xValue: 105517
      }, {
        yValue: 'Low physical activity',
        xValue: 80759
      }, {
        yValue: 'Diet low in vegetables',
        xValue: 73406
      }, {
        yValue: 'Diet low in fruits',
        xValue: 71920
      }, {
        yValue: 'Diet low in omega-3',
        xValue: 62363
      }, {
        yValue: 'Diet low in fiber',
        xValue: 54084
      }, {
        yValue: 'Diet high in sodium',
        xValue: 77534
      }, {
        yValue: 'Diet low in legumes',
        xValue: 38963
      }, {
        yValue: 'Secondhand smoke',
        xValue: 29745
      }, {
        yValue: 'Alcohol use',
        xValue: 30812
    }, {
        yValue: 'Unsafe sex',
        xValue: 20102
      }, {
        yValue: 'Drug use',
        xValue: 24517
      }, {
        yValue: 'Low birth weight',
        xValue: 11256
    }, {
        yValue: 'Diet low in calcium',
        xValue: 9526
    }, {
        yValue: 'Other',
        xValue: 15697
        }],
        name: ' in 1990'
        }, {
        data: [{
        yValue: 'Smoking',
        xValue: 0
      }, {
          yValue: 'High blood presure',
        xValue: 2739
      }, {
        yValue: 'High cholesterol',
        xValue: 0
      }, {
        yValue: 'Obesity',
        xValue: 58675
      }, {
        yValue: 'High blood sugar',
        xValue: 33497
      }, {
         yValue: 'Diet low in whole grains',
        xValue: 3784
      }, {
        yValue: 'Diet low in nuts and seeds',
        xValue: 12989
      }, {
        yValue: 'Outdoor air pollution',
        xValue: 13265
      }, {
        yValue: 'Low physical activity',
        xValue: 3333
      }, {
        yValue: 'Diet low in vegetables',
        xValue: 0
      }, {
        yValue: 'Diet low in fruits',
        xValue: 71
      }, {
        yValue: 'Diet low in omega-3',
        xValue: 0
      }, {
        yValue: 'Diet low in fiber',
        xValue: 0
      }, {
        yValue: 'Diet high in sodium',
        xValue: 21343
      }, {
        yValue: 'Diet low in legumes',
        xValue: 0
      }, {
        yValue: 'Secondhand smoke',
        xValue: 0
      }, {
        yValue: 'Alcohol use',
        xValue: 3849
    }, {
        yValue: 'Unsafe sex',
        xValue: 30812
      }, {
        yValue: 'Drug use',
        xValue: 10567
      }, {
        yValue: 'Low birth weight',
        xValue: 0
    }, {
        yValue: 'Diet low in calcium',
        xValue: 273
    }, {
        yValue: 'Other',
        xValue: 5561
        }],
        name: ' in 2000 increased by '
    }, {
        data: [{
            yValue: 'Smoking',
        xValue: 70238
      }, {
          yValue: 'High blood presure',
        xValue: 0
      }, {
        yValue: 'High cholesterol',
        xValue: 25895
      }, {
        yValue: 'Obesity',
        xValue: 0
      }, {
        yValue: 'High blood sugar',
        xValue: 0
      }, {
         yValue: 'Diet low in whole grains',
        xValue: 0
      }, {
        yValue: 'Diet low in nuts and seeds',
        xValue: 0
      }, {
        yValue: 'Outdoor air pollution',
        xValue: 0
      }, {
        yValue: 'Low physical activity',
        xValue: 0
      }, {
        yValue: 'Diet low in vegetables',
        xValue: 1682
      }, {
        yValue: 'Diet low in fruits',
        xValue: 0
      }, {
        yValue: 'Diet low in omega-3',
        xValue: 8727
      }, {
        yValue: 'Diet low in fiber',
        xValue: 7147
      }, {
        yValue: 'Diet high in sodium',
        xValue: 0
      }, {
        yValue: 'Diet low in legumes',
        xValue: 291
      }, {
        yValue: 'Secondhand smoke',
        xValue: 5803
      }, {
        yValue: 'Alcohol use',
        xValue: 0
    }, {
        yValue: 'Unsafe sex',
        xValue: 0
      }, {
        yValue: 'Drug use',
        xValue: 0
      }, {
        yValue: 'Low birth weight',
        xValue: 3498
    }, {
        yValue: 'Diet low in calcium',
        xValue: 0
    }, {
        yValue: 'Other',
        xValue: 0
        }],
        name: ' in 2000 decresed by '
      
      }];
      var series = dataset.map(function (d) {
        return d.name;
      });
      var numberOfRecords = 0;
      var dataset = dataset.map(function (d) {
        numberOfRecords = 0;
        return d.data.map(function (o, i) {
          numberOfRecords++;
          return {
            y: o.xValue,
            x: o.yValue,
            name: d.name
          };
        });
      });


      d3.select(window).on("resize", throttle);

      var stack = d3.layout.stack();

      stack(dataset);

      var dataset = dataset.map(function (group) {
        return group.map(function (d) {
          // Invert the x and y values, and y0 becomes x0
          return {
            x: d.y,
            y: d.x,
            x0: d.y0,
            name:d.name
          };
        });
      });

      var yValues = dataset[0].map(function (d) {
        return d.y;
      });

      var xMax = d3.max(dataset, function (group) {
        return d3.max(group, function (d) {
          return d.x + d.x0;
        });
      });

      var tooltip = d3.select("body")
      .append('div')
      .attr('id', 'tooltip')
      .attr('class', 'hidden');

      var width = window.innerWidth - margins.left - margins.right - legendPanel.width;
      var barHeight = 20;
      var height = (numberOfRecords * 30) - margins.top - margins.bottom;

      var svg, xScale, yScale, rects;
      
      draw(890, 470);

      function draw(width, height) {
      
        svg = d3.select("#graph")
        .append('svg')
        .attr('width', width + margins.left + margins.right)
        .attr('height', height + margins.top + margins.bottom)
        .append('g')
        .attr('transform', 'translate(' + margins.left + ',' + 10 + ')');
      
        xScale = d3.scale.linear()
        .domain([0, xMax])
        .range([0, width]);
      
        yScale = d3.scale.ordinal()
        .domain(yValues)
        .rangeRoundBands([0, height], .1);
        var xAxis = d3.svg.axis()
        .scale(xScale)
        .orient('bottom');
        var yAxis = d3.svg.axis()
        .scale(yScale)
        .orient('left');
        
        var colours = d3.scale.category10();
        var groups = svg.selectAll('g')
        .data(dataset)
        .enter()
        .append('g')
        .style('fill', function (d, i) {
          return colours(i) 


        });

        rects = groups.selectAll('rect')
        .data(function (d) {
          return d;
        })
        .enter()
        .append('rect')
        .attr('x', function (d) {
          return xScale(d.x0);
        })
        .attr('y', function (d, i) {
          return yScale(d.y);
        })
        .attr('height', function (d) {
          return barHeight;
        })
        .attr('width', function (d) {
          return xScale(d.x);
        })
        .on('mouseover', function (d) {
      
          var xPos = parseFloat(d3.select(this).attr('x')) / 2 + width / 2;
          var yPos = parseFloat(d3.select(this).attr('y')) + yScale.rangeBand() / 2;
      
          d3.select('#tooltip')
          .style('left', xPos + 'px')
          .style('top', yPos + 'px')
          .style('width', '250px')
          .text('Deaths caused by '+d.y+'  '+d.name+': '+d.x);
      
          d3.select('#tooltip').classed('hidden', false);
        })
        .on('mouseout', function () {
          d3.select('#tooltip').classed('hidden', true);
        });

        svg.append('g')
        .attr('class', 'axis')
        .attr('transform', 'translate(0,' + height + ')')
        .call(xAxis);

        svg.append('g')
        .attr('class', 'axis')
        .call(yAxis);










      }

      function redraw() {
        width = window.innerWidth - margins.left - margins.right - legendPanel.width;
        d3.select('svg').remove();
        d3.select('#legend').remove();
        draw(width,height);
      }

      var throttleTimer;
      function throttle() {
        window.clearTimeout(throttleTimer);
        throttleTimer = window.setTimeout(function() {
          redraw();
        }, 200);
      }

      
    </script>
<footer>
<div id="footer2">Copyright &#169; 2020<br/>

</div>
</footer>

</div>
</body>
</html>
